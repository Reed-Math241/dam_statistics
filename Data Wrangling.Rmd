---
title: "Data Loading and wrangling"
output:
  pdf_document: default
urlcolor: blue
---

```{r}
library(rvest)
library(tidyverse)
library(readxl)
library(janitor)
library(stringr)
library(lubridate)
library(glue)
```

Data scarping wikipedia
```{r}
link <- read_html("https://en.wikipedia.org/wiki/List_of_dams_and_reservoirs_in_Maharashtra")
daminfo <- html_node(link, 'table') %>%
  html_table(fill = TRUE)
```


loading 2015 data
```{r}
dam2015 <- read_excel("Data/2015.xlsx")%>%
  clean_names() %>%
  pivot_longer(cols = c(-reservoir_name, -district, -basin),
               names_to = "month") %>%
  mutate(day = 1) %>%
  separate(month, into = c("month", "year"), sep = "_") %>%
  mutate(date = glue(day, month, year))
  

daminfo <- daminfo %>%
  clean_names() %>%
  mutate(name_of_dam = case_when(
    name_of_dam == "Koyna" ~ "Koyana/Shivaji Sagar",
    name_of_dam == "Hatnur" ~ "Upper TapiHatnur Reservoir",
    name_of_dam == "Isapur" ~ "Isapur Reservoir",
    name_of_dam == "Upper Vaitarana" ~ "Upper Vaitarana Reservoir",
    name_of_dam == "Khadakwasla" ~ "Khadakwasla Reservoir",
    name_of_dam == "Yeldari" ~ "Yeldari Reservoir",
    name_of_dam == "Mula" ~ "Mula Reservoir",
    name_of_dam == "Jayakwadi" ~ "JayakwadiNath Sagar",
    name_of_dam == "Girna" ~ "Girna Reservoir",
    name_of_dam == "Mulshi" ~ "Mulshi Dam",
    name_of_dam == "Kanher" ~ "Kanher Dam",
    name_of_dam == "Ujani" ~ "BhimaUjjani Reservoir",
    TRUE ~ name_of_dam
  ) )

dam2015fin <- left_join(dam2015, daminfo, by = c ("reservoir_name" = "name_of_dam"))
```



